(function(e){function d(a){this.a=a;this.items=[]}function f(a,b){var c=[];a.forEach(function(a){a=a?a.toString():"";-1==a.indexOf(b)&&-1==a.indexOf('"')?c.push(a):c.push('"'+a.replace(/"/g,'""')+'"')});return c.join(b)}d.autoCreate=function(a,b){if(a&&Array.isArray(a)&&0<a.length){var c=new d(b||a[0].getOwnPropertyNames());a.forEach(function(a){c.add(a)});return c}return null};d.prototype.add=function(a){this.items.push(a)};d.prototype.b=function(a,b){a=a||",";var c=[];b&&c.push(f(this.a,a));this.items.forEach(function(b){var d=
[];this.a.forEach(function(a){d.push(b[a])});c.push(f(d,a))}.bind(this));return c.join("\r\n")};d.prototype.saveAs=function(a,b,c){b=this.b(b,c);e.saveAs(new Blob(["\ufeff",b],{type:"text/csv"}),a)};e.Csv=d})(window);